<template>
  <DocShell type="tech" title="Base de donn√©es" description="Structure et gestion des donn√©es">
    <div class="prose prose-slate max-w-none dark:prose-invert">
      <h1>Base de donn√©es</h1>
      
      <div class="not-prose bg-gradient-to-br from-cyan-50 to-blue-50 dark:from-cyan-950/20 dark:to-blue-950/20 rounded-2xl p-8 mb-12 border border-cyan-200/50 dark:border-cyan-800/30">
        <h2 class="text-2xl font-bold text-slate-900 dark:text-white mb-4">üíæ Architecture donn√©es relationnelle</h2>
        <p class="text-slate-700 dark:text-slate-300 leading-relaxed mb-6">
          Base de donn√©es MySQL 8.0 con√ßue pour performance, int√©grit√© et √©volutivit√©. 
          Structure optimis√©e pour gestion d'entreprise-r√©sidence avec relations complexes et contraintes m√©tier.
        </p>
        <div class="grid md:grid-cols-3 gap-4">
          <div class="bg-white/50 dark:bg-slate-800/50 rounded-xl p-4">
            <h3 class="font-bold text-cyan-900 dark:text-cyan-200 mb-2">üèóÔ∏è Structure</h3>
            <p class="text-sm text-slate-600 dark:text-slate-300">12 tables principales + indexes</p>
          </div>
          <div class="bg-white/50 dark:bg-slate-800/50 rounded-xl p-4">
            <h3 class="font-bold text-cyan-900 dark:text-cyan-200 mb-2">üîó Relations</h3>
            <p class="text-sm text-slate-600 dark:text-slate-300">Int√©grit√© r√©f√©rentielle stricte</p>
          </div>
          <div class="bg-white/50 dark:bg-slate-800/50 rounded-xl p-4">
            <h3 class="font-bold text-cyan-900 dark:text-cyan-200 mb-2">‚ö° Performance</h3>
            <p class="text-sm text-slate-600 dark:text-slate-300">Optimisations requ√™tes complexes</p>
          </div>
        </div>
      </div>

      <!-- Sch√©ma g√©n√©ral -->
      <h2>Sch√©ma de base de donn√©es</h2>
      
      <h3>Vue d'ensemble des tables</h3>
      <p>Architecture relationnelle avec 12 tables principales organis√©es par domaine fonctionnel :</p>
      
      <div class="not-prose bg-gray-50 dark:bg-gray-800/50 rounded-xl p-6 my-6 border border-gray-200 dark:border-gray-700">
        <h4 class="font-bold text-gray-800 dark:text-gray-200 mb-4">üìä Tables par domaine</h4>
        <div class="grid md:grid-cols-2 gap-6 text-sm">
          <div>
            <h5 class="font-semibold text-gray-900 dark:text-gray-200 mb-3">üë• Gestion Utilisateurs</h5>
            <ul class="space-y-2 text-gray-600 dark:text-gray-300">
              <li>‚Ä¢ <strong>users</strong> : Comptes utilisateurs principaux</li>
              <li>‚Ä¢ <strong>roles</strong> : R√¥les syst√®me (admin, gardien, r√©sident)</li>
              <li>‚Ä¢ <strong>permissions</strong> : Permissions granulaires</li>
              <li>‚Ä¢ <strong>user_roles</strong> : Association utilisateurs-r√¥les</li>
              <li>‚Ä¢ <strong>role_permissions</strong> : Association r√¥les-permissions</li>
            </ul>
          </div>
          <div>
            <h5 class="font-semibold text-gray-900 dark:text-gray-200 mb-3">üè¢ Gestion R√©sidence</h5>
            <ul class="space-y-2 text-gray-600 dark:text-gray-300">
              <li>‚Ä¢ <strong>badges</strong> : Badges d'acc√®s physique</li>
              <li>‚Ä¢ <strong>incidents</strong> : Incidents et demandes</li>
              <li>‚Ä¢ <strong>messages</strong> : Syst√®me de messagerie</li>
              <li>‚Ä¢ <strong>visites</strong> : Planification visites</li>
              <li>‚Ä¢ <strong>logs</strong> : Journal d'activit√© syst√®me</li>
              <li>‚Ä¢ <strong>settings</strong> : Configuration application</li>
              <li>‚Ä¢ <strong>notifications</strong> : Notifications utilisateurs</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Tables d√©taill√©es -->
      <h2>Structure d√©taill√©e des tables</h2>
      
      <h3>Table users - Utilisateurs</h3>
      <p>Table centrale pour gestion des comptes utilisateurs :</p>
      
      <div class="not-prose bg-blue-50 dark:bg-blue-950/20 rounded-xl p-6 my-6 border border-blue-200 dark:border-blue-800/30">
        <h4 class="font-bold text-blue-800 dark:text-blue-200 mb-4">üë§ Structure table users</h4>
        <div class="overflow-x-auto">
          <table class="w-full text-sm border-collapse border border-blue-200 dark:border-blue-700">
            <thead class="bg-blue-100 dark:bg-blue-900/50">
              <tr>
                <th class="border border-blue-200 dark:border-blue-700 p-3 text-left font-semibold text-blue-900 dark:text-blue-200">Champ</th>
                <th class="border border-blue-200 dark:border-blue-700 p-3 text-left font-semibold text-blue-900 dark:text-blue-200">Type</th>
                <th class="border border-blue-200 dark:border-blue-700 p-3 text-left font-semibold text-blue-900 dark:text-blue-200">Contraintes</th>
                <th class="border border-blue-200 dark:border-blue-700 p-3 text-left font-semibold text-blue-900 dark:text-blue-200">Description</th>
              </tr>
            </thead>
            <tbody class="text-blue-700 dark:text-blue-300">
              <tr>
                <td class="border border-blue-200 dark:border-blue-700 p-3"><code>id</code></td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">INT AUTO_INCREMENT</td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">PRIMARY KEY</td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">Identifiant unique</td>
              </tr>
              <tr class="bg-blue-25 dark:bg-blue-950/20">
                <td class="border border-blue-200 dark:border-blue-700 p-3"><code>email</code></td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">VARCHAR(255)</td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">UNIQUE, NOT NULL</td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">Email unique d'identification</td>
              </tr>
              <tr>
                <td class="border border-blue-200 dark:border-blue-700 p-3"><code>password</code></td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">VARCHAR(255)</td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">NOT NULL</td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">Mot de passe hash√© (bcrypt)</td>
              </tr>
              <tr class="bg-blue-25 dark:bg-blue-950/20">
                <td class="border border-blue-200 dark:border-blue-700 p-3"><code>nom</code></td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">VARCHAR(100)</td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">NOT NULL</td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">Nom de famille</td>
              </tr>
              <tr>
                <td class="border border-blue-200 dark:border-blue-700 p-3"><code>prenom</code></td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">VARCHAR(100)</td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">NOT NULL</td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">Pr√©nom</td>
              </tr>
              <tr class="bg-blue-25 dark:bg-blue-950/20">
                <td class="border border-blue-200 dark:border-blue-700 p-3"><code>telephone</code></td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">VARCHAR(20)</td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">NULL</td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">Num√©ro de t√©l√©phone</td>
              </tr>
              <tr>
                <td class="border border-blue-200 dark:border-blue-700 p-3"><code>adresse</code></td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">TEXT</td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">NULL</td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">Adresse compl√®te</td>
              </tr>
              <tr class="bg-blue-25 dark:bg-blue-950/20">
                <td class="border border-blue-200 dark:border-blue-700 p-3"><code>actif</code></td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">BOOLEAN</td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">DEFAULT TRUE</td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">Statut actif/inactif</td>
              </tr>
              <tr>
                <td class="border border-blue-200 dark:border-blue-700 p-3"><code>created_at</code></td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">TIMESTAMP</td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">DEFAULT CURRENT_TIMESTAMP</td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">Date de cr√©ation</td>
              </tr>
              <tr class="bg-blue-25 dark:bg-blue-950/20">
                <td class="border border-blue-200 dark:border-blue-700 p-3"><code>updated_at</code></td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">TIMESTAMP</td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">ON UPDATE CURRENT_TIMESTAMP</td>
                <td class="border border-blue-200 dark:border-blue-700 p-3">Date de modification</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <h3>Table badges - Contr√¥le d'acc√®s</h3>
      <p>Gestion des badges d'acc√®s physique et permissions :</p>
      
      <div class="not-prose bg-green-50 dark:bg-green-950/20 rounded-xl p-6 my-6 border border-green-200 dark:border-green-800/30">
        <h4 class="font-bold text-green-800 dark:text-green-200 mb-4">üè∑Ô∏è Structure table badges</h4>
        <div class="grid md:grid-cols-2 gap-4 text-sm">
          <div>
            <h5 class="font-semibold text-green-900 dark:text-green-200 mb-2">Champs principaux</h5>
            <ul class="space-y-1 text-green-700 dark:text-green-300">
              <li>‚Ä¢ <code>id</code> : Identifiant unique (PK)</li>
              <li>‚Ä¢ <code>user_id</code> : R√©f√©rence utilisateur (FK)</li>
              <li>‚Ä¢ <code>numero_badge</code> : Num√©ro physique unique</li>
              <li>‚Ä¢ <code>type_badge</code> : r√©sident|visiteur|prestataire</li>
              <li>‚Ä¢ <code>statut</code> : actif|suspendu|r√©voqu√©</li>
            </ul>
          </div>
          <div>
            <h5 class="font-semibold text-green-900 dark:text-green-200 mb-2">M√©tadonn√©es</h5>
            <ul class="space-y-1 text-green-700 dark:text-green-300">
              <li>‚Ä¢ <code>date_emission</code> : Date de cr√©ation</li>
              <li>‚Ä¢ <code>date_expiration</code> : Date d'expiration</li>
              <li>‚Ä¢ <code>zones_acces</code> : JSON zones autoris√©es</li>
              <li>‚Ä¢ <code>horaires_acces</code> : JSON cr√©neaux</li>
              <li>‚Ä¢ <code>derniere_utilisation</code> : Timestamp</li>
            </ul>
          </div>
        </div>
      </div>

      <h3>Table incidents - Gestion d'incidents</h3>
      <p>Workflow complet de traitement des incidents et demandes :</p>
      
      <div class="not-prose bg-orange-50 dark:bg-orange-950/20 rounded-xl p-6 my-6 border border-orange-200 dark:border-orange-800/30">
        <h4 class="font-bold text-orange-800 dark:text-orange-200 mb-4">üö® Structure table incidents</h4>
        <div class="grid md:grid-cols-2 gap-4 text-sm">
          <div>
            <h5 class="font-semibold text-orange-900 dark:text-orange-200 mb-2">Identification</h5>
            <ul class="space-y-1 text-orange-700 dark:text-orange-300">
              <li>‚Ä¢ <code>id</code> : Identifiant unique</li>
              <li>‚Ä¢ <code>user_id</code> : Utilisateur d√©clarant</li>
              <li>‚Ä¢ <code>assigned_to</code> : Assign√© √† (gardien/admin)</li>
              <li>‚Ä¢ <code>numero_ticket</code> : Num√©ro public unique</li>
              <li>‚Ä¢ <code>titre</code> : Titre descriptif</li>
            </ul>
          </div>
          <div>
            <h5 class="font-semibold text-orange-900 dark:text-orange-200 mb-2">Workflow</h5>
            <ul class="space-y-1 text-orange-700 dark:text-orange-300">
              <li>‚Ä¢ <code>statut</code> : ouvert|en_cours|r√©solu|ferm√©</li>
              <li>‚Ä¢ <code>priorite</code> : basse|normale|haute|urgente</li>
              <li>‚Ä¢ <code>categorie</code> : technique|s√©curit√©|entretien</li>
              <li>‚Ä¢ <code>localisation</code> : Zone/appartement concern√©</li>
              <li>‚Ä¢ <code>resolution</code> : Description solution</li>
            </ul>
          </div>
        </div>
      </div>

      <h3>Table messages - Syst√®me de messagerie</h3>
      <p>Communication s√©curis√©e entre utilisateurs :</p>
      
      <div class="not-prose bg-purple-50 dark:bg-purple-950/20 rounded-xl p-6 my-6 border border-purple-200 dark:border-purple-800/30">
        <h4 class="font-bold text-purple-800 dark:text-purple-200 mb-4">üí¨ Structure table messages</h4>
        <div class="overflow-x-auto">
          <table class="w-full text-sm border-collapse border border-purple-200 dark:border-purple-700">
            <thead class="bg-purple-100 dark:bg-purple-900/50">
              <tr>
                <th class="border border-purple-200 dark:border-purple-700 p-3 text-left font-semibold text-purple-900 dark:text-purple-200">Champ</th>
                <th class="border border-purple-200 dark:border-purple-700 p-3 text-left font-semibold text-purple-900 dark:text-purple-200">Type</th>
                <th class="border border-purple-200 dark:border-purple-700 p-3 text-left font-semibold text-purple-900 dark:text-purple-200">Description</th>
              </tr>
            </thead>
            <tbody class="text-purple-700 dark:text-purple-300">
              <tr>
                <td class="border border-purple-200 dark:border-purple-700 p-3"><code>from_user_id</code></td>
                <td class="border border-purple-200 dark:border-purple-700 p-3">INT</td>
                <td class="border border-purple-200 dark:border-purple-700 p-3">Exp√©diteur (FK users)</td>
              </tr>
              <tr class="bg-purple-25 dark:bg-purple-950/20">
                <td class="border border-purple-200 dark:border-purple-700 p-3"><code>to_user_id</code></td>
                <td class="border border-purple-200 dark:border-purple-700 p-3">INT</td>
                <td class="border border-purple-200 dark:border-purple-700 p-3">Destinataire (FK users)</td>
              </tr>
              <tr>
                <td class="border border-purple-200 dark:border-purple-700 p-3"><code>sujet</code></td>
                <td class="border border-purple-200 dark:border-purple-700 p-3">VARCHAR(255)</td>
                <td class="border border-purple-200 dark:border-purple-700 p-3">Sujet du message</td>
              </tr>
              <tr class="bg-purple-25 dark:bg-purple-950/20">
                <td class="border border-purple-200 dark:border-purple-700 p-3"><code>contenu</code></td>
                <td class="border border-purple-200 dark:border-purple-700 p-3">TEXT</td>
                <td class="border border-purple-200 dark:border-purple-700 p-3">Corps du message</td>
              </tr>
              <tr>
                <td class="border border-purple-200 dark:border-purple-700 p-3"><code>lu</code></td>
                <td class="border border-purple-200 dark:border-purple-700 p-3">BOOLEAN</td>
                <td class="border border-purple-200 dark:border-purple-700 p-3">Statut de lecture</td>
              </tr>
              <tr class="bg-purple-25 dark:bg-purple-950/20">
                <td class="border border-purple-200 dark:border-purple-700 p-3"><code>date_lecture</code></td>
                <td class="border border-purple-200 dark:border-purple-700 p-3">TIMESTAMP</td>
                <td class="border border-purple-200 dark:border-purple-700 p-3">Horodatage lecture</td>
              </tr>
              <tr>
                <td class="border border-purple-200 dark:border-purple-700 p-3"><code>priorite</code></td>
                <td class="border border-purple-200 dark:border-purple-700 p-3">ENUM</td>
                <td class="border border-purple-200 dark:border-purple-700 p-3">normale|importante|urgente</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Relations et int√©grit√© -->
      <h2>Relations et int√©grit√© r√©f√©rentielle</h2>
      
      <h3>Contraintes de cl√©s √©trang√®res</h3>
      <p>Relations strictes pour garantir la coh√©rence des donn√©es :</p>
      
      <div class="not-prose bg-red-50 dark:bg-red-950/20 rounded-xl p-6 my-6 border border-red-200 dark:border-red-800/30">
        <h4 class="font-bold text-red-800 dark:text-red-200 mb-4">üîó Relations principales</h4>
        <div class="space-y-4 text-sm">
          <div class="bg-red-100 dark:bg-red-900/30 rounded-lg p-4 border border-red-200 dark:border-red-800">
            <h5 class="font-semibold text-red-900 dark:text-red-200 mb-2">üë§ Gestion utilisateurs</h5>
            <ul class="text-red-700 dark:text-red-300 space-y-1">
              <li>‚Ä¢ <code>user_roles.user_id</code> ‚Üí <code>users.id</code> (CASCADE DELETE)</li>
              <li>‚Ä¢ <code>user_roles.role_id</code> ‚Üí <code>roles.id</code> (CASCADE DELETE)</li>
              <li>‚Ä¢ <code>role_permissions.role_id</code> ‚Üí <code>roles.id</code> (CASCADE DELETE)</li>
              <li>‚Ä¢ <code>role_permissions.permission_id</code> ‚Üí <code>permissions.id</code> (CASCADE DELETE)</li>
            </ul>
          </div>
          <div class="bg-orange-100 dark:bg-orange-900/30 rounded-lg p-4 border border-orange-200 dark:border-orange-800">
            <h5 class="font-semibold text-orange-900 dark:text-orange-200 mb-2">üè∑Ô∏è Badges et acc√®s</h5>
            <ul class="text-orange-700 dark:text-orange-300 space-y-1">
              <li>‚Ä¢ <code>badges.user_id</code> ‚Üí <code>users.id</code> (CASCADE DELETE)</li>
              <li>‚Ä¢ <code>visites.user_id</code> ‚Üí <code>users.id</code> (SET NULL)</li>
              <li>‚Ä¢ <code>visites.badge_id</code> ‚Üí <code>badges.id</code> (SET NULL)</li>
            </ul>
          </div>
          <div class="bg-blue-100 dark:bg-blue-900/30 rounded-lg p-4 border border-blue-200 dark:border-blue-800">
            <h5 class="font-semibold text-blue-900 dark:text-blue-200 mb-2">üö® Incidents et messages</h5>
            <ul class="text-blue-700 dark:text-blue-300 space-y-1">
              <li>‚Ä¢ <code>incidents.user_id</code> ‚Üí <code>users.id</code> (CASCADE DELETE)</li>
              <li>‚Ä¢ <code>incidents.assigned_to</code> ‚Üí <code>users.id</code> (SET NULL)</li>
              <li>‚Ä¢ <code>messages.from_user_id</code> ‚Üí <code>users.id</code> (CASCADE DELETE)</li>
              <li>‚Ä¢ <code>messages.to_user_id</code> ‚Üí <code>users.id</code> (CASCADE DELETE)</li>
            </ul>
          </div>
        </div>
      </div>

      <h3>Indexes et optimisations</h3>
      <p>Indexes strat√©giques pour performance des requ√™tes fr√©quentes :</p>
      
      <div class="not-prose grid md:grid-cols-2 gap-6 my-8">
        <div class="bg-indigo-50 dark:bg-indigo-950/20 rounded-xl p-6 border border-indigo-200 dark:border-indigo-800/30">
          <h4 class="font-bold text-indigo-800 dark:text-indigo-200 mb-4">üìä Indexes primaires</h4>
          <ul class="text-sm text-indigo-700 dark:text-indigo-300 space-y-2">
            <li>‚Ä¢ <strong>users.email</strong> : UNIQUE (authentification)</li>
            <li>‚Ä¢ <strong>badges.numero_badge</strong> : UNIQUE (identification)</li>
            <li>‚Ä¢ <strong>incidents.numero_ticket</strong> : UNIQUE (r√©f√©rence)</li>
            <li>‚Ä¢ <strong>messages(from_user_id, to_user_id)</strong> : Composite</li>
            <li>‚Ä¢ <strong>logs.created_at</strong> : Recherche temporelle</li>
          </ul>
        </div>
        <div class="bg-teal-50 dark:bg-teal-950/20 rounded-xl p-6 border border-teal-200 dark:border-teal-800/30">
          <h4 class="font-bold text-teal-800 dark:text-teal-200 mb-4">üöÄ Indexes de performance</h4>
          <ul class="text-sm text-teal-700 dark:text-teal-300 space-y-2">
            <li>‚Ä¢ <strong>incidents(statut, priorite)</strong> : Filtrage rapide</li>
            <li>‚Ä¢ <strong>badges(statut, type_badge)</strong> : Recherche badges</li>
            <li>‚Ä¢ <strong>messages.lu</strong> : Messages non lus</li>
            <li>‚Ä¢ <strong>user_roles.user_id</strong> : V√©rification permissions</li>
            <li>‚Ä¢ <strong>notifications.user_id</strong> : Notifications utilisateur</li>
          </ul>
        </div>
      </div>

      <!-- Configuration et maintenance -->
      <h2>Configuration et maintenance</h2>
      
      <h3>Configuration MySQL</h3>
      <p>Param√®tres optimis√©s pour performance et s√©curit√© :</p>
      
      <div class="not-prose bg-yellow-50 dark:bg-yellow-950/20 rounded-xl p-6 my-6 border border-yellow-200 dark:border-yellow-800/30">
        <h4 class="font-bold text-yellow-800 dark:text-yellow-200 mb-4">‚öôÔ∏è Param√®tres recommand√©s</h4>
        <div class="grid md:grid-cols-2 gap-4 text-sm">
          <div>
            <h5 class="font-semibold text-yellow-900 dark:text-yellow-200 mb-2">Performance</h5>
            <ul class="space-y-1 text-yellow-700 dark:text-yellow-300">
              <li>‚Ä¢ <code>innodb_buffer_pool_size</code> : 70% RAM</li>
              <li>‚Ä¢ <code>max_connections</code> : 200</li>
              <li>‚Ä¢ <code>query_cache_size</code> : 64M</li>
              <li>‚Ä¢ <code>innodb_log_file_size</code> : 256M</li>
              <li>‚Ä¢ <code>tmp_table_size</code> : 64M</li>
            </ul>
          </div>
          <div>
            <h5 class="font-semibold text-yellow-900 dark:text-yellow-200 mb-2">S√©curit√©</h5>
            <ul class="space-y-1 text-yellow-700 dark:text-yellow-300">
              <li>‚Ä¢ <code>sql_mode</code> : STRICT_TRANS_TABLES</li>
              <li>‚Ä¢ <code>local_infile</code> : 0 (d√©sactiv√©)</li>
              <li>‚Ä¢ <code>skip_symbolic_links</code> : ON</li>
              <li>‚Ä¢ <code>secure_file_priv</code> : /secure/dir</li>
              <li>‚Ä¢ SSL/TLS obligatoire pour connexions</li>
            </ul>
          </div>
        </div>
      </div>

      <h3>Strat√©gie de sauvegarde</h3>
      <p>Plan de sauvegarde robuste pour protection des donn√©es :</p>
      
      <ol>
        <li><strong>Sauvegarde compl√®te :</strong>
          <ul>
            <li>Fr√©quence : Quotidienne √† 2h00</li>
            <li>M√©thode : mysqldump avec --single-transaction</li>
            <li>Compression : gzip pour r√©duction taille</li>
            <li>Stockage : Hors site + local (7 jours)</li>
          </ul>
        </li>
        <li><strong>Sauvegarde incr√©mentale :</strong>
          <ul>
            <li>Fr√©quence : Toutes les 4 heures</li>
            <li>M√©thode : Binary logs MySQL</li>
            <li>R√©tention : 48 heures local</li>
            <li>Point-in-time recovery possible</li>
          </ul>
        </li>
        <li><strong>Tests de restauration :</strong>
          <ul>
            <li>Validation hebdomadaire automatique</li>
            <li>Environnement de test d√©di√©</li>
            <li>M√©triques de temps de restauration</li>
            <li>Documentation proc√©dures d'urgence</li>
          </ul>
        </li>
      </ol>

      <h3>Monitoring et alertes</h3>
      <p>Surveillance proactive de la sant√© de la base :</p>
      
      <div class="not-prose bg-green-50 dark:bg-green-950/20 rounded-xl p-6 my-6 border border-green-200 dark:border-green-800/30">
        <h4 class="font-bold text-green-800 dark:text-green-200 mb-4">üìà M√©triques surveill√©es</h4>
        <div class="grid md:grid-cols-2 gap-4 text-sm">
          <div>
            <h5 class="font-semibold text-green-900 dark:text-green-200 mb-2">Performance</h5>
            <ul class="space-y-1 text-green-700 dark:text-green-300">
              <li>‚Ä¢ <strong>Temps r√©ponse</strong> : < 100ms (SELECT), < 500ms (UPDATE)</li>
              <li>‚Ä¢ <strong>Connexions actives</strong> : Alert si > 150</li>
              <li>‚Ä¢ <strong>Requ√™tes lentes</strong> : Log si > 2s</li>
              <li>‚Ä¢ <strong>Buffer pool hit ratio</strong> : > 95%</li>
            </ul>
          </div>
          <div>
            <h5 class="font-semibold text-green-900 dark:text-green-200 mb-2">Ressources</h5>
            <ul class="space-y-1 text-green-700 dark:text-green-300">
              <li>‚Ä¢ <strong>Espace disque</strong> : Alert si < 20% libre</li>
              <li>‚Ä¢ <strong>CPU usage</strong> : Alert si > 80% sustained</li>
              <li>‚Ä¢ <strong>Memory usage</strong> : Monitor swap usage</li>
              <li>‚Ä¢ <strong>R√©plication lag</strong> : Alert si > 30s</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Migration et √©volution -->
      <h2>Migration et √©volution du sch√©ma</h2>
      
      <h3>Gestion des migrations Laravel</h3>
      <p>√âvolution contr√¥l√©e du sch√©ma de base de donn√©es :</p>
      
      <div class="not-prose bg-indigo-50 dark:bg-indigo-950/20 rounded-xl p-6 my-6 border border-indigo-200 dark:border-indigo-800/30">
        <h4 class="font-bold text-indigo-800 dark:text-indigo-200 mb-4">üîÑ Process de migration</h4>
        <div class="space-y-4 text-sm">
          <div class="bg-indigo-100 dark:bg-indigo-900/30 rounded-lg p-4 border border-indigo-200 dark:border-indigo-800">
            <h5 class="font-semibold text-indigo-900 dark:text-indigo-200 mb-2">1. D√©veloppement</h5>
            <ul class="text-indigo-700 dark:text-indigo-300 space-y-1">
              <li>‚Ä¢ Cr√©ation migration : <code>php artisan make:migration</code></li>
              <li>‚Ä¢ Test en local : <code>php artisan migrate</code></li>
              <li>‚Ä¢ Rollback test : <code>php artisan migrate:rollback</code></li>
              <li>‚Ä¢ Validation structure et donn√©es</li>
            </ul>
          </div>
          <div class="bg-yellow-100 dark:bg-yellow-900/30 rounded-lg p-4 border border-yellow-200 dark:border-yellow-800">
            <h5 class="font-semibold text-yellow-900 dark:text-yellow-200 mb-2">2. Staging</h5>
            <ul class="text-yellow-700 dark:text-yellow-300 space-y-1">
              <li>‚Ä¢ Copie donn√©es production vers staging</li>
              <li>‚Ä¢ Ex√©cution migration avec donn√©es r√©elles</li>
              <li>‚Ä¢ Tests complets application</li>
              <li>‚Ä¢ Validation performance queries</li>
            </ul>
          </div>
          <div class="bg-green-100 dark:bg-green-900/30 rounded-lg p-4 border border-green-200 dark:border-green-800">
            <h5 class="font-semibold text-green-900 dark:text-green-200 mb-2">3. Production</h5>
            <ul class="text-green-700 dark:text-green-300 space-y-1">
              <li>‚Ä¢ Sauvegarde compl√®te pr√©-migration</li>
              <li>‚Ä¢ Mode maintenance activ√©</li>
              <li>‚Ä¢ Migration avec monitoring</li>
              <li>‚Ä¢ Validation post-migration</li>
            </ul>
          </div>
        </div>
      </div>

      <h3>√âvolutions pr√©vues</h3>
      <p>Roadmap d'am√©lioration du sch√©ma de donn√©es :</p>
      
      <ul>
        <li><strong>Performance :</strong> Partitioning des tables logs par date</li>
        <li><strong>Audit :</strong> Tables d'audit automatique pour tra√ßabilit√©</li>
        <li><strong>Analytics :</strong> Vues mat√©rialis√©es pour reporting</li>
        <li><strong>Archive :</strong> Strat√©gie d'archivage donn√©es anciennes</li>
        <li><strong>R√©plication :</strong> Read replicas pour scalabilit√©</li>
      </ul>

      <!-- Conclusion -->
      <div class="not-prose bg-gradient-to-br from-cyan-50 to-blue-50 dark:from-cyan-950/20 dark:to-blue-950/20 rounded-2xl p-8 mt-12 border border-cyan-200/50 dark:border-cyan-800/30">
        <h2 class="text-2xl font-bold text-slate-900 dark:text-white mb-4">üíé Base de donn√©es robuste et √©volutive</h2>
        <p class="text-slate-700 dark:text-slate-300 leading-relaxed mb-6">
          Cette architecture de base de donn√©es garantit performance, int√©grit√© et s√©curit√© pour la gestion d'entreprise-r√©sidence. 
          Les optimisations et la strat√©gie de maintenance assurent une √©volutivit√© √† long terme.
        </p>
        <div class="grid md:grid-cols-3 gap-4">
          <div class="bg-white/50 dark:bg-slate-800/50 rounded-xl p-4">
            <h3 class="font-bold text-cyan-900 dark:text-cyan-200 mb-2">üîí Int√©grit√©</h3>
            <p class="text-sm text-slate-600 dark:text-slate-300">Contraintes strictes et validation</p>
          </div>
          <div class="bg-white/50 dark:bg-slate-800/50 rounded-xl p-4">
            <h3 class="font-bold text-cyan-900 dark:text-cyan-200 mb-2">‚ö° Performance</h3>
            <p class="text-sm text-slate-600 dark:text-slate-300">Indexes optimis√©s et requ√™tes rapides</p>
          </div>
          <div class="bg-white/50 dark:bg-slate-800/50 rounded-xl p-4">
            <h3 class="font-bold text-cyan-900 dark:text-cyan-200 mb-2">üîÑ √âvolutivit√©</h3>
            <p class="text-sm text-slate-600 dark:text-slate-300">Migrations contr√¥l√©es et extensibilit√©</p>
          </div>
        </div>
      </div>
    </div>
  </DocShell>
</template>

<script setup lang="ts">
  import { onMounted } from 'vue'
  import { useTheme } from '../../composables/useTheme'
  
  // Import du syst√®me de th√®me
  const { initTheme } = useTheme()
  useHead({ title: 'Base de donn√©es - Documentation technique' })

  onMounted(() => {
    initTheme()
  })
</script>


